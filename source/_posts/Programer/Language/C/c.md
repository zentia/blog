---
title: C语言高级部分总结
date: 2017-10-22 09:31:46
tags:
  - c
---

# 先被声明为‘extern’后又被声明为‘static’
In file included from src/mt_mysql_connector.cpp:14:0:
/usr/include/mysql/my_global.h: 在函数‘double log2(double)’中:
/usr/include/mysql/my_global.h:823:35: 错误：‘double log2(double)’先被声明为‘extern’后又被声明为‘static’ [-fpermissive]
 static inline double log2(double x)
static 声明的全局变量只能在当前源文件中使用。
extern不是定义，是引入（声明）在其它源文件中定义的非static全局变量

# 内存大话题
## 内存就是程序的立足之地，体现内存重要性。
# 内存理解:内存物理看是有很多个Bank（就是行列珍式的存储芯片），每一个Bank的列就是位宽，每一行就是Words，则存储单元数量=行数（words）x列数（位宽）xBank的数量；通常也用MxW的方式来表示芯片的容量（或者说是芯片的规格/组织结构）。
M是以位宽为单位的总容量，单位是兆，W代表位宽，单位是bit。计算出来的芯片容量也是以bit为单位，但用户可以采用除以8的方法换算为字节（Byte）。比如8Mx8，这是一个8bit位宽芯片，有8M个存储单元，总容量是64Mbit（8MB）。
- c语言中其实没有bool类型:以0表示假，非0表示真，则在内存存储是以int型存放的。如果想要表示真假，可以用int/char型做替换，在c++中就有bool x=true/false。
- 内存对齐:提高内存访问效率，编译器一般默认是4字节
- char/int/short/long/float/double类型
放在内存的长度和解析作用。(int*)0，使用0地址指向一个int行。又如0000111010101可以解析成int型也可以解析成float型。
- Linux内核是面向对象的，而c语言是面向过程的，但可以用结构体内嵌指针变成面向对象。如
```c
struct student
{
    int age;
    int length;
    char *name;
    void (*eat)(void); // 实现多态
};
```
- 栈的理解：
1. 运行时自动分配&自动回收：栈是自动管理的，代码无需干预。（表现在汇编代码，编译时，会自动编译成汇编实现函数调用完立即改变栈顶）
2. 反复使用：栈内存在程序中其实就是那一块空间，程序反复使用这一块空间（硬件上有个寄存器，用来存放栈的栈顶地址，栈是有大小的空间）
3. 脏内存：栈内存由于反复使用，每次使用后程序不会去清理，因此分配到原来保留的值。
4. 临时性：函数不能返回栈变量的指针，因为这个空间是临时的。
5. 栈会溢出：因为操作系统事先给定了栈的大小，如果在函数中无穷尽的分配栈内存总能用完。栈的操作是由具体硬件干预的，我们只要明白原理就可以了，但是要给相应的栈寄存器赋值。当调用函数时，变量会自动放在栈中（入栈）当函数调用完后，栈会自动出栈。
6. 栈的“发展”有四种情况，满增栈，满减栈，空增栈，空减栈，至于是哪种要根据编译器决定，而s5pv32是满减栈。
- 堆的理解
1. 操作系统堆管理器管理，堆管理器是操作系统的一个模块，堆管理器内存分配灵活，按需分配。
2. 大块内存：堆内存管理者总量很大的操作系统内存块，各进程可以按需申请使用，使用完释放。
3. 脏内存：堆内存也是反复使用的，而且使用者用完释放前不会清除，因此也是脏的。
4. 临时性：堆内存只在malloc和free之间属于当前进程，可以访问，在malloc和free之后都不能在访问，否则会有不可预料的后果。
5. 程序手申请释放
